<div class="container">
    <div class="container">
        <h1>Agregar Productos</h1>
        <form action="./realtimeproducts" method="POST" id="productForm">
            <label for="code">Código</label>
            <input type="text" id="code" name="code" required>
        
            <label for="title">Título</label>
            <input type="text" id="title" name="title" required>
            
            <label for="priceList">Precio</label>
            <input type="text" id="priceList" name="priceList" required>
            
            <label for="description">Descripción</label>
            <input type="text" id="description" name="description" required>
            
            
            <label for="stock">Stock</label>
            <input type="text" id="stock" name="stock" required>
            
            <label for="category">Categoría</label>
            <select id="category" name="category" required>
                <option value="botiquin">Botiquín</option>
                <option value="aromaterapia">Aromaterapia</option>
                <option value="frecuente">Frecuente</option>
            </select>
            
    
            
            <input type="hidden" id="status" name="status" value="true">
            
            <button type="submit" id="submitBtn">Agregar Producto</button>
        </form>
    </div>
    <h1>LISTA DE PRODUCTOS</h1>

    <ul>
        
        {{#each products.docs}}
            <li>
                <span>{{this.code}}</span>
                <span>{{this.title}}</span>
                <span>{{this.description}}</span>
                <span>${{this.priceList}}</span>
            </li>
        {{/each}}
    </ul>

    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-center">
            {{#if products.hasPrevPage}}
                <li class="page-item">
                    <a class="page-link" href="/views/realtimeproducts/?page={{products.prevPage}}&limit={{products.limit}}" aria-label="Previous">
                        <i class="fa fa-chevron-left"></i>
                    </a>
                </li>
            {{/if}}
            <li class="page-item disabled">
                <span class="page-link">Página {{products.page}} de {{products.totalPages}}</span>
            </li>
            {{#if products.hasNextPage}}
                <li class="page-item">
                    <a class="page-link" href="/views/realtimeproducts/?page={{products.nextPage}}&limit={{products.limit}}" aria-label="Next">
                        <i class="fa fa-chevron-right"></i>
                    </a>
                </li>
            {{/if}}
        </ul>
    </nav>


</div>

<script src="/socket.io/socket.io.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.14.1/dist/sweetalert2.all.min.js"></script>
<script type="module">
    const url = "";
    const option = {};
    const socketClient = io(url,option);
    
    

    socketClient.on("connect", () => {
        console.log(`connected to ${url}`);

        socketClient.on('newProduct', (product) => {
        console.log('Nuevo producto agregado:', product);
        
        const productList = document.getElementById('productList');
            const newProductElement = document.createElement('li');
            newProductElement.innerHTML = `
                <span class="product-name">${product.title}</span>
                <span class="product-price">$${product.priceList}</span>
            `;
            productList.appendChild(newProductElement);
        });
    });
        
    

</script>